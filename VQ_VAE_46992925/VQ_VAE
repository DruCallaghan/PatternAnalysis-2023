'''
VQ-VAE
'''
import os
import torch
import torch.nn as nn
import torchvision.transforms as transforms
import numpy as np
from tqdm import tqdm
from PIL import Image
import torch.utils.data
from torchvision import datasets, transforms, utils
import matplotlib.pyplot as plt

device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
print("Torch version ", torch.__version__)


path = "C:/Users/61423/COMP3710/data/keras_png_slices_data/"
output_path = path+"data/mnist/output_torch_"+"GAN"+"/"




def load_data_from_folder(name):
    data = []
    for filename in os.listdir(path+name):
        
        image_path = os.path.join(path+name, filename)
        image = Image.open(image_path)
        image = np.array(image)  
        data.append(image)
        
    return np.array(data)

print("> Loading Test data")

train_data = torch.from_numpy(load_data_from_folder("keras_png_slices_test/")).to(device)
train_loader = torch.utils.data.DataLoader(train_data, batch_size=128, shuffle=True)

print("> Test Data Finsihed Loading")
print("The shape of the data is: ", train_data.shape)